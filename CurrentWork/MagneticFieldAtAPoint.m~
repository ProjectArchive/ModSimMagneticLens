
function res = MagneticFieldAtAPoint(rMeasure)
rad = .05;
d = .05;
I = 50;
mu
rX = rMeasure(1);
rY = rMeasure(2);
rZ = rMeasure(3);
if rX>rad || rX<-rad || rY>rad || rX<-rad || rZ>d/2 || rZ<-d/2
    res = [0;0;0];
else
    res =quadv(@(theta) theIntegrand(rMeasure,theta),0,2*pi);
end



function iRes = theIntegrand(rMeasure,theta)
rSource1 = [rad*cos(theta);rad*sin(theta);0]; % parametize the source curve of dipoles
%rSource2 = [rad*cos(theta);rad*sin(theta);-d];
dL = [rad*-sin(theta);rad*cos(theta);0];
iRes = loopBFieldofR(rMeasure,rSource1,dL);
end

function magField = magneticFieldOfR(rMeasure,rSource)
displacement =(rMeasure-rSource);
coefficients = mu_0/(norm(displacement)^3);
D_hat = (displacement)/norm(displacement);
magField = coefficients*(3*(dot(magVec,D_hat))*D_hat - magVec);
end

function magField = loopBFieldofR(rMeasure,rSource,dL)
displacement =(rMeasure-rSource);
coefficients = I*mu_0/(norm(displacement)^3);
magField = coefficients*cross(dL,displacement);
end
end